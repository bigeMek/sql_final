SELECT *
FROM czechia_payroll

SELECT *
FROM czechia_payroll_calculation

SELECT *
FROM czechia_payroll_industry_branch

SELECT *
FROM czechia_payroll_unit

SELECT *
FROM czechia_payroll_value_type

SELECT *
FROM czechia_price 

SELECT *
FROM czechia_price_category 

SELECT *
FROM czechia_region 

SELECT *
FROM czechia_district



SELECT
  cpib.name AS name,
  cp.industry_branch_code AS industry_code,
  cp.payroll_year AS year,
  ROUND(AVG(cp.value), 1) AS avg_sallary
FROM czechia_payroll cp
LEFT JOIN czechia_payroll_calculation cpc ON cp.value_type_code = cpc.code
INNER JOIN czechia_payroll_unit cpu ON cpu.code = cp.unit_code
LEFT JOIN czechia_payroll_industry_branch cpib ON cpib.code = cp.industry_branch_code
WHERE cp.calculation_code = '100'
  AND cp.value_type_code = '5958'
GROUP BY
  cpib.name,
  cp.industry_branch_code,
  cp.payroll_year
ORDER BY
  cp.payroll_year desc,
  --cp.industry_branch_code;
	avg_sallary desc


CREATE OR REPLACE VIEW v_platy_v_letech AS
SELECT
  cpib.name AS name,
  cp.industry_branch_code AS industry_code,
  cp.payroll_year AS year,
  ROUND(AVG(cp.value), 1) AS avg_sallary
FROM czechia_payroll cp
LEFT JOIN czechia_payroll_calculation cpc ON cp.value_type_code = cpc.code
INNER JOIN czechia_payroll_unit cpu ON cpu.code = cp.unit_code
LEFT JOIN czechia_payroll_industry_branch cpib ON cpib.code = cp.industry_branch_code
WHERE cp.calculation_code = '100'
  AND cp.value_type_code = '5958'
  AND cpib.name IS NOT NULL
GROUP BY
  cpib.name,
  cp.industry_branch_code,
  cp.payroll_year
ORDER BY
	cp.payroll_year asc,
 	--cp.industry_branch_code;
	--avg_sallary DESC
	cp.industry_branch_code



SELECT * FROM v_platy_v_letech


SELECT *
FROM
	czechia_price cp
INNER JOIN czechia_price_category cpc ON code = category_code
LEFT JOIN czechia_region cr ON cr.code = region_code


SELECT *
FROM czechia_region

	

SELECT
	cpc.name AS nazev_potraviny,
	price_value AS mnozstvi,
	price_unit AS jednotky,
	value AS cena,
	cr.name AS kraj,
	extract(YEAR FROM cp.date_from) AS rok
FROM
	czechia_price cp
INNER JOIN czechia_price_category cpc ON cpc.code = cp.category_code
LEFT JOIN czechia_region cr ON cr.code = cp.region_code
GROUP BY
	cpc.name,
	price_value,
	price_unit,
	cp.value,
	cr.name,
	cp.date_from
	
