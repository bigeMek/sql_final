SELECT *
FROM czechia_payroll

SELECT *
FROM czechia_payroll_calculation

SELECT *
FROM czechia_payroll_industry_branch

SELECT *
FROM czechia_payroll_unit

SELECT *
FROM czechia_payroll_value_type

SELECT *
FROM czechia_price 

SELECT *
FROM czechia_price_category 

SELECT *
FROM czechia_region 

SELECT *
FROM czechia_district



SELECT
  cpib.name AS name,
  cp.industry_branch_code AS industry_code,
  cp.payroll_year AS year,
  ROUND(AVG(cp.value), 1) AS avg_sallary
FROM czechia_payroll cp
LEFT JOIN czechia_payroll_calculation cpc ON cp.value_type_code = cpc.code
INNER JOIN czechia_payroll_unit cpu ON cpu.code = cp.unit_code
LEFT JOIN czechia_payroll_industry_branch cpib ON cpib.code = cp.industry_branch_code
WHERE cp.calculation_code = '100'
  AND cp.value_type_code = '5958'
GROUP BY
  cpib.name,
  cp.industry_branch_code,
  cp.payroll_year
ORDER BY
  cp.payroll_year desc,
  --cp.industry_branch_code;
	avg_sallary desc


